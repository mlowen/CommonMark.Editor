/*! bootstrap-commonmark-editor 0.4.0 Copyright (c) 2014, 2015 Mike Lowen */
!function(){var e=function(e,n){var t=function(t){var i=this,o=n.Parser(),l=n.HtmlRenderer();i.element=e('<div class="'+t+'"></div>'),i.hide=function(){i.element.hide()},i.show=function(){i.element.show()},i.toggle=function(){i.element.toggle()},i.visible=function(){i.element.is(":visible")},i.commonmark=function(e){i.element.html(l.render(o.parse(e)))},i.html=function(){i.element.html()}},i=function(n){var t=this,i={on:function(e,n){t.element.on(e,n)},trigger:function(n,i){t.element.trigger(new e.Event(n,i))},types:{preview:"cm-editor-header-preview",edit:"cm-editor-header-edit",toggle:"cm-editor-header-toggle"}};t.element=e('<div class="cm-editor-header"></div>'),t.on={preview:function(e){i.on(i.types.preview,e)},edit:function(e){i.on(i.types.edit,e)},toggle:function(e){i.on(i.types.toggle,e)}},t.trigger={preview:function(e){i.trigger(i.types.preview,e)},edit:function(e){i.trigger(i.types.edit,e)},toggle:function(e){i.trigger(i.types.toggle)}},t.toggle=function(){n.toggle&&(c.hasClass(r)?c.removeClass(r).addClass(a):c.removeClass(a).addClass(r)),l&&l.toggle(),o.toggle()};var o=e('<ul class="tabs"></ul>').append(e("<li></li>").append(e('<a href="#" class="active">Edit</a>').click(function(){return t.trigger.edit({element:this}),!1}))).append(e("<li></li>").append(e('<a href="#">Preview</a>').click(function(){return t.trigger.preview({element:this}),!1})));if(n.inline){var l=null;if(n.toggle){var r="glyphicon-pencil",a="glyphicon-remove",c=e('<span class="glyphicon"></span>').addClass(r),g=e('<a href="#" class="pull-right toggle"></a>').append(c);g.click(function(e){e.preventDefault(),t.trigger.toggle()}),t.element.append(g)}o.hide(),n.title&&(l=e('<strong class="title"></strong>').text(n.title),t.element.append(l))}n.header||t.element.addClass("transparent"),t.element.append(o);var s=function(n){t.element.find("li a.active").removeClass("active"),e(n.element).addClass("active")};t.on.edit(s),t.on.preview(s)},o=function(n){var i=this,o=null,l={change:"cm-editor-content-change"},r=e('<textarea class="form-control"></textarea>'),a=new t("preview");n.name&&r.attr("name",n.name),i.states={edit:1,preview:2},i.element=e('<div class="cm-editor-content"></div>').append(r).append(a.element),i.state=function(e){return"undefined"==typeof e?o:void(e!=o&&(o=e,o==i.states.edit?(r.show(),a.hide()):(r.hide(),a.show())))},i.val=function(e){return"undefined"!=typeof e&&r.val()!==e&&(r.val(e),r.change()),r.val()},i.html=function(){return a.html()},i.show=function(){i.element.show()},i.hide=function(){i.element.hide()},i.toggle=function(){i.element.toggle()},i.on={change:function(e){i.element.on(l.change,e)}},i.trigger={change:function(n){i.element.trigger(new e.Event(l.change,n))}};var c=function(){var e=r.val();a.commonmark(e),i.trigger.change({text:e})};r.change(c).keydown(c).keyup(c),i.state(i.states.edit)},l=function(){var n=this,t="disabled",i=e('<button class="btn btn-default">Revert changes</button>'),o=e('<button class="btn btn-success pull-right">Save</button>'),l={save:"cm-editor-footer-save",revert:"cm-editor-footer-revert"};n.element=e('<div class="cm-editor-footer"></div>'),n.disable=function(){o.prop(t,!0),i.prop(t,!0)},n.enable=function(){o.prop(t,!1),i.prop(t,!1)},n.show=function(){n.element.show()},n.hide=function(){n.element.hide()},n.toggle=function(){n.element.toggle()},n.on={save:function(e){n.element.on(l.save,e)},revert:function(e){n.element.on(l.revert,e)}},n.trigger={save:function(){n.element.trigger(new e.Event(l.save))},revert:function(){n.element.trigger(new e.Event(l.revert))}},o.click(function(e){e.preventDefault(),n.trigger.save()}),i.click(function(e){e.preventDefault(),n.trigger.revert()}),n.element.append(i).append(o),n.disable()},r=function(n,r){var a=this,c="",g="",s={on:function(e,n){a.element.on(e,n)},trigger:function(n,t){a.element.trigger(new e.Event(n,t))},types:{change:"cm-editor-changed",inlineToggle:"cm-editor-inline-toggle"}};a.element=e(n),a.val=function(e){return"undefined"!=typeof e&&c!==e&&(c=e,u.val(c),g=u.html(),v&&v.commonmark(c),a.trigger.change({text:c})),c},a.html=function(e){return g},a.inline=function(e){if(!r.inline)return!1;var n=v.visible();return"undefined"!=typeof e&&n!=e&&(u.toggle(),v.toggle(),d.toggle(),r.save&&m.toggle(),a.trigger.inlineToggle()),v.visible()},a.on={change:function(e){s.on(s.types.change,e)},inlineToggle:function(e){s.on(s.types.inlineToggle,e)}},a.trigger={change:function(e){s.trigger(s.types.change,e)},inlineToggle:function(){s.trigger(s.types.inlineToggle)}};var d=new i(r),u=new o(r),m=r.save?new l:null,v=r.inline?new t("inline-content"):null;d.on.edit(function(){u.state(u.states.edit)}),d.on.preview(function(){u.state(u.states.preview)}),u.on.change(function(e){r.save?e.text===c?m.disable():m.enable():a.val(e.text)}),r.save&&(m.on.save(function(){a.val(u.val())}),m.on.revert(function(){u.val(a.val())})),r.inline&&(u.hide(),r.save&&m.hide(),d.on.toggle(function(){a.inline(!a.inline())}));var f=e('<div class="cm-editor-body"></div>').append(u.element);m&&f.append(m.element),v&&f.append(v.element),a.element.addClass("commonmark-editor").append(d.element).append(f),a.val(r.text)};e.fn.commonMarkEditor=function(n){return n=e.extend({header:!0,inline:!1,name:null,save:!1,text:"",title:"",toggle:!0},n),this.map(function(e,t){return new r(t,n)})}},n="function"==typeof define&&define.amd;n&&define(["jquery","commonmark"],e),jQuery&&commonmark?e(jQuery,commonmark):n||console.log("Unavble to load dependency for Bootstrap Commonmark Editor.")}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb3RzdHJhcC1jb21tb25tYXJrLWVkaXRvci5qcyIsInByZWZpeC5qcyIsInJlbmRlcmVyLmpzIiwiaGVhZGVyLmpzIiwiY29udGVudC5qcyIsImZvb3Rlci5qcyIsImVkaXRvci5qcyIsImJpbmRpbmcuanMiLCJzdWZmaXguanMiXSwibmFtZXMiOlsiaW5pdCIsIiQiLCJjb21tb25tYXJrIiwiUmVuZGVyZXIiLCJjbGFzc05hbWUiLCJzZWxmIiwidGhpcyIsInJlYWRlciIsIlBhcnNlciIsIndyaXRlciIsIkh0bWxSZW5kZXJlciIsImVsZW1lbnQiLCJoaWRlIiwic2hvdyIsInRvZ2dsZSIsInZpc2libGUiLCJpcyIsInRleHQiLCJodG1sIiwicmVuZGVyIiwicGFyc2UiLCJIZWFkZXIiLCJvcHRpb25zIiwiZXZlbnRzIiwib24iLCJ0eXBlIiwiY2FsbGJhY2siLCJ0cmlnZ2VyIiwiZGF0YSIsIkV2ZW50IiwidHlwZXMiLCJwcmV2aWV3IiwiZWRpdCIsImdseXBoIiwiaGFzQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImFkZENsYXNzIiwiY2FuY2VsIiwidGl0bGUiLCJ0YWJzIiwiYXBwZW5kIiwiY2xpY2siLCJpbmxpbmUiLCJlIiwicHJldmVudERlZmF1bHQiLCJoZWFkZXIiLCJmaW5kIiwiQ29udGVudCIsInN0YXRlIiwiY2hhbmdlIiwidGV4dGFyZWEiLCJuYW1lIiwiYXR0ciIsInN0YXRlcyIsInMiLCJ2YWwiLCJ2YWx1ZSIsIm9uQ2hhbmdlIiwia2V5ZG93biIsImtleXVwIiwiRm9vdGVyIiwicHJvcGVydHkiLCJyZXZlcnQiLCJzYXZlIiwiZGlzYWJsZSIsInByb3AiLCJlbmFibGUiLCJFZGl0b3IiLCJpbmxpbmVUb2dnbGUiLCJjb250ZW50IiwiaW5saW5lQ29udGVudCIsImlzSW5saW5lIiwiZm9vdGVyIiwiYm9keSIsImZuIiwiY29tbW9uTWFya0VkaXRvciIsImV4dGVuZCIsIm1hcCIsImluZGV4IiwiaXRlbSIsImFtZEF2YWlsYWJsZSIsImRl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QUFBaUMsR0FFQXBFLEVBQUFrRCxJQUFBakMsRUFBQUwsTUMvR0FoQixHQUFBeUUsR0FBQUMsaUJBQUEsU0FBQXJELEdBV0EsTUFWQUEsR0FBQXJCLEVBQUEyRSxRQUNBL0IsUUFBQSxFQUNBSCxRQUFBLEVBQ0FTLEtBQUEsS0FDQVksTUFBQSxFQUNBOUMsS0FBQSxHQUNBcUIsTUFBQSxHQUNBeEIsUUFBQSxHQUNBUSxHQUVBaEIsS0FBQXVFLElBQUEsU0FBQUMsRUFBQUMsR0FBQSxNQUFBLElBQUFaLEdBQUFZLEVBQUF6RCxPQ1RBMEQsRUFBQSxrQkFBQUMsU0FBQUEsT0FBQUMsR0FFQUYsSUFDQUMsUUFBQSxTQUFBLGNBQUFqRixHQUVBbUYsUUFBQWpGLFdBQ0FGLEVBQUFtRixPQUFBakYsWUFDQThFLEdBQ0FJLFFBQUFDLElBQUEiLCJmaWxlIjoiYm9vdHN0cmFwLWNvbW1vbm1hcmstZWRpdG9yLmpzIiwic291cmNlc0NvbnRlbnQiOltudWxsLCIoZnVuY3Rpb24oKSB7XHJcblx0dmFyIGluaXQgPSBmdW5jdGlvbigkLCBjb21tb25tYXJrKSB7IiwidmFyIFJlbmRlcmVyID0gZnVuY3Rpb24oY2xhc3NOYW1lKSB7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdFxyXG5cdHZhciByZWFkZXIgPSBjb21tb25tYXJrLlBhcnNlcigpO1xyXG5cdHZhciB3cml0ZXIgPSBjb21tb25tYXJrLkh0bWxSZW5kZXJlcigpO1xyXG5cclxuXHRzZWxmLmVsZW1lbnQgPSAkKCc8ZGl2IGNsYXNzPVwiJyArIGNsYXNzTmFtZSArICdcIj48L2Rpdj4nKTtcclxuXHJcblx0c2VsZi5oaWRlID0gZnVuY3Rpb24oKSB7IHNlbGYuZWxlbWVudC5oaWRlKCk7IH07XHJcblx0c2VsZi5zaG93ID0gZnVuY3Rpb24oKSB7IHNlbGYuZWxlbWVudC5zaG93KCk7IH07XHJcblx0c2VsZi50b2dnbGUgPSBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LnRvZ2dsZSgpOyB9O1xyXG5cdHNlbGYudmlzaWJsZSA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQuaXMoJzp2aXNpYmxlJyk7IH07XHJcblx0XHJcblx0c2VsZi5jb21tb25tYXJrID0gZnVuY3Rpb24odGV4dCkge1xyXG5cdFx0c2VsZi5lbGVtZW50Lmh0bWwod3JpdGVyLnJlbmRlcihyZWFkZXIucGFyc2UodGV4dCkpKTtcclxuXHR9O1xyXG5cdFxyXG5cdHNlbGYuaHRtbCA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQuaHRtbCgpOyB9O1xyXG59OyIsInZhciBIZWFkZXIgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdHZhciBldmVudHMgPSB7XHJcblx0XHRvbjogZnVuY3Rpb24odHlwZSwgY2FsbGJhY2spIHtcclxuXHRcdFx0c2VsZi5lbGVtZW50Lm9uKHR5cGUsIGNhbGxiYWNrKTtcclxuXHRcdH0sXHJcblx0XHR0cmlnZ2VyOiBmdW5jdGlvbih0eXBlLCBkYXRhKSB7XHJcblx0XHRcdHNlbGYuZWxlbWVudC50cmlnZ2VyKG5ldyAkLkV2ZW50KHR5cGUsIGRhdGEpKTtcclxuXHRcdH0sXHJcblx0XHR0eXBlczogeyBcclxuXHRcdFx0cHJldmlldzogJ2NtLWVkaXRvci1oZWFkZXItcHJldmlldycsIFxyXG5cdFx0XHRlZGl0OiAnY20tZWRpdG9yLWhlYWRlci1lZGl0JywgXHJcblx0XHRcdHRvZ2dsZTogJ2NtLWVkaXRvci1oZWFkZXItdG9nZ2xlJyBcclxuXHRcdH1cclxuXHR9O1xyXG5cdFxyXG5cdC8qIFB1YmxpYyBBUEkgKi9cclxuXHRzZWxmLmVsZW1lbnQgPSAkKCc8ZGl2IGNsYXNzPVwiY20tZWRpdG9yLWhlYWRlclwiPjwvZGl2PicpO1xyXG5cdFxyXG5cdC8vIEV2ZW50c1xyXG5cdHNlbGYub24gPSB7XHJcblx0XHRwcmV2aWV3OiBmdW5jdGlvbihjYWxsYmFjaykgeyBldmVudHMub24oZXZlbnRzLnR5cGVzLnByZXZpZXcsIGNhbGxiYWNrKTsgfSxcclxuXHRcdGVkaXQ6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7IGV2ZW50cy5vbihldmVudHMudHlwZXMuZWRpdCwgY2FsbGJhY2spOyB9LFxyXG5cdFx0dG9nZ2xlOiBmdW5jdGlvbihjYWxsYmFjaykgeyBldmVudHMub24oZXZlbnRzLnR5cGVzLnRvZ2dsZSwgY2FsbGJhY2spOyB9XHJcblx0fTtcclxuXHRcclxuXHRzZWxmLnRyaWdnZXIgPSB7XHJcblx0XHRwcmV2aWV3OiBmdW5jdGlvbihkYXRhKSB7IGV2ZW50cy50cmlnZ2VyKGV2ZW50cy50eXBlcy5wcmV2aWV3LCBkYXRhKTsgfSxcclxuXHRcdGVkaXQ6IGZ1bmN0aW9uKGRhdGEpIHsgZXZlbnRzLnRyaWdnZXIoZXZlbnRzLnR5cGVzLmVkaXQsIGRhdGEpOyB9LFxyXG5cdFx0dG9nZ2xlOiBmdW5jdGlvbihkYXRhKSB7IGV2ZW50cy50cmlnZ2VyKGV2ZW50cy50eXBlcy50b2dnbGUpOyB9XHJcblx0fTtcclxuXHRcclxuXHRzZWxmLnRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0aWYob3B0aW9ucy50b2dnbGUpIHtcclxuXHRcdFx0aWYoZ2x5cGguaGFzQ2xhc3MoZWRpdCkpIHtcclxuXHRcdFx0XHRnbHlwaC5yZW1vdmVDbGFzcyhlZGl0KS5hZGRDbGFzcyhjYW5jZWwpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGdseXBoLnJlbW92ZUNsYXNzKGNhbmNlbCkuYWRkQ2xhc3MoZWRpdCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcclxuXHRcdGlmKHRpdGxlKSB0aXRsZS50b2dnbGUoKTtcclxuXHRcclxuXHRcdHRhYnMudG9nZ2xlKCk7XHJcblx0fTtcclxuXHRcclxuXHQvKiBDb25zdHJ1Y3RvciAqL1xyXG5cdFxyXG5cdHZhciB0YWJzID0gJCgnPHVsIGNsYXNzPVwidGFic1wiPjwvdWw+JylcclxuXHRcdC5hcHBlbmQoXHJcblx0XHRcdCQoJzxsaT48L2xpPicpLmFwcGVuZChcclxuXHRcdFx0XHQkKCc8YSBocmVmPVwiI1wiIGNsYXNzPVwiYWN0aXZlXCI+RWRpdDwvYT4nKS5jbGljayhmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdHNlbGYudHJpZ2dlci5lZGl0KHsgZWxlbWVudDogdGhpcyB9KTtcclxuXHRcclxuXHRcdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0XHR9KVxyXG5cdFx0XHQpXHJcblx0XHQpXHJcblx0XHQuYXBwZW5kKFxyXG5cdFx0XHQkKCc8bGk+PC9saT4nKS5hcHBlbmQoXHJcblx0XHRcdFx0JCgnPGEgaHJlZj1cIiNcIj5QcmV2aWV3PC9hPicpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyLnByZXZpZXcoeyBlbGVtZW50OiB0aGlzIH0pO1xyXG5cdFxyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdClcclxuXHRcdCk7XHJcblx0XHJcblx0aWYob3B0aW9ucy5pbmxpbmUpIHtcclxuXHRcdHZhciB0aXRsZSA9IG51bGw7XHJcblx0XHJcblx0XHRpZihvcHRpb25zLnRvZ2dsZSkge1xyXG5cdFx0XHR2YXIgZWRpdCA9ICdnbHlwaGljb24tcGVuY2lsJztcclxuXHRcdFx0dmFyIGNhbmNlbCA9ICdnbHlwaGljb24tcmVtb3ZlJztcclxuXHRcclxuXHRcdFx0dmFyIGdseXBoID0gJCgnPHNwYW4gY2xhc3M9XCJnbHlwaGljb25cIj48L3NwYW4+JykuYWRkQ2xhc3MoZWRpdCk7XHJcblx0XHRcdHZhciB0b2dnbGUgPSAkKCc8YSBocmVmPVwiI1wiIGNsYXNzPVwicHVsbC1yaWdodCB0b2dnbGVcIj48L2E+JykuYXBwZW5kKGdseXBoKTtcclxuXHRcclxuXHRcdFx0dG9nZ2xlLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuXHRcdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdFx0c2VsZi50cmlnZ2VyLnRvZ2dsZSgpO1xyXG5cdFx0XHR9KTtcclxuXHRcclxuXHRcdFx0c2VsZi5lbGVtZW50LmFwcGVuZCh0b2dnbGUpO1xyXG5cdFx0fVxyXG5cdFxyXG5cdFx0dGFicy5oaWRlKCk7XHJcblx0XHJcblx0XHRpZihvcHRpb25zLnRpdGxlKSB7XHJcblx0XHRcdHRpdGxlID0gJCgnPHN0cm9uZyBjbGFzcz1cInRpdGxlXCI+PC9zdHJvbmc+JykudGV4dChvcHRpb25zLnRpdGxlKTtcclxuXHRcdFx0c2VsZi5lbGVtZW50LmFwcGVuZCh0aXRsZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdGlmKCFvcHRpb25zLmhlYWRlcilcclxuXHRcdHNlbGYuZWxlbWVudC5hZGRDbGFzcygndHJhbnNwYXJlbnQnKTtcclxuXHRcclxuXHRzZWxmLmVsZW1lbnQuYXBwZW5kKHRhYnMpO1xyXG5cdFxyXG5cdC8vIFRpZSB1cCBpbnRlcm5hbCBldmVudHNcclxuXHR2YXIgY2xpY2sgPSBmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRzZWxmLmVsZW1lbnQuZmluZCgnbGkgYS5hY3RpdmUnKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcblx0XHQkKGRhdGEuZWxlbWVudCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG5cdH07XHJcblx0XHJcblx0c2VsZi5vbi5lZGl0KGNsaWNrKTtcclxuXHRzZWxmLm9uLnByZXZpZXcoY2xpY2spO1xyXG59IiwidmFyIENvbnRlbnQgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdHZhciBzdGF0ZSA9IG51bGw7XHJcblx0dmFyIGV2ZW50cyA9IHsgY2hhbmdlOiAnY20tZWRpdG9yLWNvbnRlbnQtY2hhbmdlJyB9O1xyXG5cclxuXHR2YXIgdGV4dGFyZWEgPSAkKCc8dGV4dGFyZWEgY2xhc3M9XCJmb3JtLWNvbnRyb2xcIj48L3RleHRhcmVhPicpO1xyXG5cdHZhciBwcmV2aWV3ID0gbmV3IFJlbmRlcmVyKCdwcmV2aWV3Jyk7XHJcblxyXG5cdGlmKG9wdGlvbnMubmFtZSlcclxuXHRcdHRleHRhcmVhLmF0dHIoJ25hbWUnLCBvcHRpb25zLm5hbWUpO1xyXG5cclxuXHQvKiBQdWJsaWMgQVBJICovXHJcblx0c2VsZi5zdGF0ZXMgPSB7IGVkaXQ6IDEsIHByZXZpZXc6IDIgfVxyXG5cdHNlbGYuZWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJjbS1lZGl0b3ItY29udGVudFwiPjwvZGl2PicpXHJcblx0XHQuYXBwZW5kKHRleHRhcmVhKVxyXG5cdFx0LmFwcGVuZChwcmV2aWV3LmVsZW1lbnQpO1xyXG5cclxuXHQvLyBNZXRob2RzXHJcblx0c2VsZi5zdGF0ZSA9IGZ1bmN0aW9uKHMpIHtcclxuXHRcdGlmKHR5cGVvZiBzID09PSAndW5kZWZpbmVkJykgcmV0dXJuIHN0YXRlO1xyXG5cdFx0aWYocyA9PSBzdGF0ZSkgcmV0dXJuO1xyXG5cclxuXHRcdHN0YXRlID0gcztcclxuXHJcblx0XHRpZihzdGF0ZSA9PSBzZWxmLnN0YXRlcy5lZGl0KSB7XHJcblx0XHRcdHRleHRhcmVhLnNob3coKTtcclxuXHRcdFx0cHJldmlldy5oaWRlKCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHR0ZXh0YXJlYS5oaWRlKCk7XHJcblx0XHRcdHByZXZpZXcuc2hvdygpO1xyXG5cdFx0fVxyXG5cdH07XHJcblxyXG5cdHNlbGYudmFsID0gZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdC8vIExldHMgbm90IGNhdXNlIHVubmVjZXNzYXJ5IHJlc2V0dGluZyBvZiB0ZXh0IGFuZCBmaXJlIHVubmVlZGVkIGV2ZW50cy5cclxuXHRcdGlmKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdGV4dGFyZWEudmFsKCkgIT09IHZhbHVlKSB7XHRcclxuXHRcdFx0dGV4dGFyZWEudmFsKHZhbHVlKTtcclxuXHRcdFx0dGV4dGFyZWEuY2hhbmdlKCk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiB0ZXh0YXJlYS52YWwoKTtcclxuXHR9O1xyXG5cdFxyXG5cdHNlbGYuaHRtbCA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gcHJldmlldy5odG1sKCk7IH07XHJcblxyXG5cdHNlbGYuc2hvdyA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQuc2hvdygpOyB9O1xyXG5cdHNlbGYuaGlkZSA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQuaGlkZSgpOyB9O1xyXG5cdHNlbGYudG9nZ2xlID0gZnVuY3Rpb24oKSB7IHNlbGYuZWxlbWVudC50b2dnbGUoKTsgfTtcclxuXHJcblx0Ly8gRXZlbnRzXHJcblx0c2VsZi5vbiA9IHsgY2hhbmdlOiBmdW5jdGlvbihjYWxsYmFjaykgeyBzZWxmLmVsZW1lbnQub24oZXZlbnRzLmNoYW5nZSwgY2FsbGJhY2spOyB9IH07XHJcblx0c2VsZi50cmlnZ2VyID0geyBjaGFuZ2U6IGZ1bmN0aW9uKGRhdGEpIHsgc2VsZi5lbGVtZW50LnRyaWdnZXIobmV3ICQuRXZlbnQoZXZlbnRzLmNoYW5nZSwgZGF0YSkpOyB9IH07XHJcblxyXG5cdC8vIENvbnN0cnVjdFxyXG5cclxuXHR2YXIgb25DaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB0ZXh0ID0gdGV4dGFyZWEudmFsKCk7XHJcblxyXG5cdFx0cHJldmlldy5jb21tb25tYXJrKHRleHQpO1xyXG5cdFx0c2VsZi50cmlnZ2VyLmNoYW5nZSh7IHRleHQ6IHRleHQgfSk7XHJcblx0fTtcclxuXHJcblx0dGV4dGFyZWEuY2hhbmdlKG9uQ2hhbmdlKS5rZXlkb3duKG9uQ2hhbmdlKS5rZXl1cChvbkNoYW5nZSk7XHJcblxyXG5cdHNlbGYuc3RhdGUoc2VsZi5zdGF0ZXMuZWRpdCk7XHJcbn0iLCJ2YXIgRm9vdGVyID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdHZhciBwcm9wZXJ0eSA9ICdkaXNhYmxlZCc7XHJcblx0dmFyIHJldmVydCA9ICQoJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLWRlZmF1bHRcIj5SZXZlcnQgY2hhbmdlczwvYnV0dG9uPicpO1xyXG5cdHZhciBzYXZlID0gJCgnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc3VjY2VzcyBwdWxsLXJpZ2h0XCI+U2F2ZTwvYnV0dG9uPicpO1xyXG5cdHZhciBldmVudHMgPSB7IHNhdmU6ICdjbS1lZGl0b3ItZm9vdGVyLXNhdmUnLCByZXZlcnQ6ICdjbS1lZGl0b3ItZm9vdGVyLXJldmVydCcgfTtcclxuXHJcblx0LyogUHVibGljIEFQSSAqL1xyXG5cdHNlbGYuZWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJjbS1lZGl0b3ItZm9vdGVyXCI+PC9kaXY+Jyk7XHJcblxyXG5cdC8vIE1ldGhvZHNcclxuXHRzZWxmLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHNhdmUucHJvcChwcm9wZXJ0eSwgdHJ1ZSk7XHJcblx0XHRyZXZlcnQucHJvcChwcm9wZXJ0eSwgdHJ1ZSk7XHJcblx0fTtcclxuXHJcblx0c2VsZi5lbmFibGUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHNhdmUucHJvcChwcm9wZXJ0eSwgZmFsc2UpO1xyXG5cdFx0cmV2ZXJ0LnByb3AocHJvcGVydHksIGZhbHNlKTtcclxuXHR9O1xyXG5cclxuXHRzZWxmLnNob3cgPSBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LnNob3coKTsgfTtcclxuXHRzZWxmLmhpZGUgPSBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LmhpZGUoKTsgfTtcclxuXHRzZWxmLnRvZ2dsZSA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQudG9nZ2xlKCk7IH07XHJcblxyXG5cdC8vIEV2ZW50c1xyXG5cdHNlbGYub24gPSB7XHJcblx0XHRzYXZlOiBmdW5jdGlvbihjYWxsYmFjaykgeyBzZWxmLmVsZW1lbnQub24oZXZlbnRzLnNhdmUsIGNhbGxiYWNrKTsgfSxcclxuXHRcdHJldmVydDogZnVuY3Rpb24oY2FsbGJhY2spIHsgc2VsZi5lbGVtZW50Lm9uKGV2ZW50cy5yZXZlcnQsIGNhbGxiYWNrKTsgfSxcclxuXHR9O1xyXG5cclxuXHRzZWxmLnRyaWdnZXIgPSB7XHJcblx0XHRzYXZlOiBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LnRyaWdnZXIobmV3ICQuRXZlbnQoZXZlbnRzLnNhdmUpKTsgfSxcclxuXHRcdHJldmVydDogZnVuY3Rpb24oKSB7IHNlbGYuZWxlbWVudC50cmlnZ2VyKG5ldyAkLkV2ZW50KGV2ZW50cy5yZXZlcnQpKTsgfSxcclxuXHR9O1xyXG5cclxuXHQvKiBDb25zdHJ1Y3QgKi9cclxuXHRzYXZlLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHNlbGYudHJpZ2dlci5zYXZlKCk7XHJcblx0fSk7XHJcblxyXG5cdHJldmVydC5jbGljayhmdW5jdGlvbihlKSB7XHJcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRzZWxmLnRyaWdnZXIucmV2ZXJ0KCk7XHJcblx0fSk7XHJcblxyXG5cdHNlbGYuZWxlbWVudC5hcHBlbmQocmV2ZXJ0KS5hcHBlbmQoc2F2ZSk7XHJcblx0c2VsZi5kaXNhYmxlKCk7XHJcbn07IiwidmFyIEVkaXRvciA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0dmFyIHRleHQgPSAnJztcclxuXHR2YXIgaHRtbCA9ICcnO1xyXG5cclxuXHR2YXIgZXZlbnRzID0ge1xyXG5cdFx0b246IGZ1bmN0aW9uKHR5cGUsIGNhbGxiYWNrKSB7IHNlbGYuZWxlbWVudC5vbih0eXBlLCBjYWxsYmFjayk7IH0sXHJcblx0XHR0cmlnZ2VyOiBmdW5jdGlvbih0eXBlLCBkYXRhKSB7IHNlbGYuZWxlbWVudC50cmlnZ2VyKG5ldyAkLkV2ZW50KHR5cGUsIGRhdGEpKTsgfSxcclxuXHRcdHR5cGVzOiB7IGNoYW5nZTogJ2NtLWVkaXRvci1jaGFuZ2VkJywgaW5saW5lVG9nZ2xlOiAnY20tZWRpdG9yLWlubGluZS10b2dnbGUnIH1cclxuXHR9O1xyXG5cclxuXHQvKiBQdWJsaWMgQVBJICovXHJcblx0c2VsZi5lbGVtZW50ID0gJChlbGVtZW50KTtcclxuXHJcblx0Ly8gTWV0aG9kc1xyXG5cdHNlbGYudmFsID0gZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdGlmKHR5cGVvZiB2YWx1ZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdGV4dCAhPT0gdmFsdWUpIHtcclxuXHRcdFx0dGV4dCA9IHZhbHVlO1xyXG5cdFx0XHRjb250ZW50LnZhbCh0ZXh0KTtcclxuXHRcdFx0aHRtbCA9IGNvbnRlbnQuaHRtbCgpO1xyXG5cdFxyXG5cdFx0XHRpZihpbmxpbmVDb250ZW50KVxyXG5cdFx0XHRcdGlubGluZUNvbnRlbnQuY29tbW9ubWFyayh0ZXh0KTtcclxuXHRcclxuXHRcdFx0c2VsZi50cmlnZ2VyLmNoYW5nZSh7IHRleHQ6IHRleHQgfSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiB0ZXh0O1xyXG5cdH07XHJcblxyXG5cdHNlbGYuaHRtbCA9IGZ1bmN0aW9uKHZhbHVlKSB7IHJldHVybiBodG1sOyB9O1xyXG5cclxuXHRzZWxmLmlubGluZSA9IGZ1bmN0aW9uKHZhbHVlKSB7XHJcblx0XHRpZighb3B0aW9ucy5pbmxpbmUpXHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHJcblx0XHR2YXIgaXNJbmxpbmUgPSBpbmxpbmVDb250ZW50LnZpc2libGUoKTtcclxuXHJcblx0XHRpZih0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnICYmIGlzSW5saW5lICE9IHZhbHVlKSB7XHJcblx0XHRcdGNvbnRlbnQudG9nZ2xlKCk7XHJcblx0XHRcdGlubGluZUNvbnRlbnQudG9nZ2xlKCk7XHJcblx0XHRcdGhlYWRlci50b2dnbGUoKTtcclxuXHRcclxuXHRcdFx0aWYob3B0aW9ucy5zYXZlKVxyXG5cdFx0XHRcdGZvb3Rlci50b2dnbGUoKTtcclxuXHRcclxuXHRcdFx0c2VsZi50cmlnZ2VyLmlubGluZVRvZ2dsZSgpO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHRyZXR1cm4gaW5saW5lQ29udGVudC52aXNpYmxlKCk7XHJcblx0fTtcclxuXHJcblx0Ly8gRXZlbnRzXHJcblxyXG5cdHNlbGYub24gPSB7XHJcblx0XHRjaGFuZ2U6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7IGV2ZW50cy5vbihldmVudHMudHlwZXMuY2hhbmdlLCBjYWxsYmFjayk7IH0sXHJcblx0XHRpbmxpbmVUb2dnbGU6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7IGV2ZW50cy5vbihldmVudHMudHlwZXMuaW5saW5lVG9nZ2xlLCBjYWxsYmFjayk7IH1cclxuXHR9O1xyXG5cclxuXHRzZWxmLnRyaWdnZXIgPSB7XHJcblx0XHRjaGFuZ2U6IGZ1bmN0aW9uKGRhdGEpIHsgZXZlbnRzLnRyaWdnZXIoZXZlbnRzLnR5cGVzLmNoYW5nZSwgZGF0YSk7IH0sXHJcblx0XHRpbmxpbmVUb2dnbGU6IGZ1bmN0aW9uKCkgeyBldmVudHMudHJpZ2dlcihldmVudHMudHlwZXMuaW5saW5lVG9nZ2xlKTsgfVxyXG5cdH07XHJcblxyXG5cdC8qIENvbnN0cnVjdG9yICovXHJcblx0dmFyIGhlYWRlciA9IG5ldyBIZWFkZXIob3B0aW9ucyk7XHJcblx0dmFyIGNvbnRlbnQgPSBuZXcgQ29udGVudChvcHRpb25zKTtcclxuXHR2YXIgZm9vdGVyID0gb3B0aW9ucy5zYXZlID8gbmV3IEZvb3RlcigpIDogbnVsbDtcclxuXHR2YXIgaW5saW5lQ29udGVudCA9IG9wdGlvbnMuaW5saW5lID8gbmV3IFJlbmRlcmVyKCdpbmxpbmUtY29udGVudCcpIDogbnVsbDtcclxuXHJcblx0Ly8gU3Vic2NyaWJlIHRvIGV2ZW50c1xyXG5cclxuXHRoZWFkZXIub24uZWRpdChmdW5jdGlvbigpIHsgY29udGVudC5zdGF0ZShjb250ZW50LnN0YXRlcy5lZGl0KTsgfSk7XHJcblx0aGVhZGVyLm9uLnByZXZpZXcoZnVuY3Rpb24oKSB7IGNvbnRlbnQuc3RhdGUoY29udGVudC5zdGF0ZXMucHJldmlldyk7IH0pO1xyXG5cclxuXHRjb250ZW50Lm9uLmNoYW5nZShmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRpZihvcHRpb25zLnNhdmUpIHtcclxuXHRcdFx0aWYoZGF0YS50ZXh0ID09PSB0ZXh0KSBmb290ZXIuZGlzYWJsZSgpO1xyXG5cdFx0XHRlbHNlIGZvb3Rlci5lbmFibGUoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHNlbGYudmFsKGRhdGEudGV4dCk7XHJcblx0XHR9XHJcblx0fSk7XHJcblxyXG5cdGlmKG9wdGlvbnMuc2F2ZSkge1xyXG5cdFx0Zm9vdGVyLm9uLnNhdmUoZnVuY3Rpb24oKSB7IHNlbGYudmFsKGNvbnRlbnQudmFsKCkpOyB9KTtcclxuXHRcdGZvb3Rlci5vbi5yZXZlcnQoZnVuY3Rpb24oKSB7IGNvbnRlbnQudmFsKHNlbGYudmFsKCkpOyB9KTtcclxuXHR9XHJcblxyXG5cdGlmKG9wdGlvbnMuaW5saW5lKSB7XHJcblx0XHRjb250ZW50LmhpZGUoKTtcclxuXHJcblx0XHRpZihvcHRpb25zLnNhdmUpXHJcblx0XHRcdGZvb3Rlci5oaWRlKCk7XHJcblxyXG5cdFx0aGVhZGVyLm9uLnRvZ2dsZShmdW5jdGlvbiAoKSB7IHNlbGYuaW5saW5lKCFzZWxmLmlubGluZSgpKTsgfSk7XHJcblx0fVxyXG5cclxuXHQvLyBBZGQgYWxsIHRoZSBlbGVtZW50c1xyXG5cdHZhciBib2R5ID0gJCgnPGRpdiBjbGFzcz1cImNtLWVkaXRvci1ib2R5XCI+PC9kaXY+JykuYXBwZW5kKGNvbnRlbnQuZWxlbWVudCk7XHJcblxyXG5cdGlmKGZvb3RlcilcclxuXHRcdGJvZHkuYXBwZW5kKGZvb3Rlci5lbGVtZW50KTtcclxuXHJcblx0aWYoaW5saW5lQ29udGVudClcclxuXHRcdGJvZHkuYXBwZW5kKGlubGluZUNvbnRlbnQuZWxlbWVudCk7XHJcblxyXG5cdHNlbGYuZWxlbWVudC5hZGRDbGFzcygnY29tbW9ubWFyay1lZGl0b3InKVxyXG5cdFx0LmFwcGVuZChoZWFkZXIuZWxlbWVudClcclxuXHRcdC5hcHBlbmQoYm9keSk7XHJcblxyXG5cdHNlbGYudmFsKG9wdGlvbnMudGV4dCk7XHJcbn0iLCIkLmZuLmNvbW1vbk1hcmtFZGl0b3IgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0b3B0aW9ucyA9ICQuZXh0ZW5kKHtcclxuXHRcdGhlYWRlcjogdHJ1ZSxcclxuXHRcdGlubGluZTogZmFsc2UsXHJcblx0XHRuYW1lOiBudWxsLFxyXG5cdFx0c2F2ZTogZmFsc2UsXHJcblx0XHR0ZXh0OiAnJyxcclxuXHRcdHRpdGxlOiAnJyxcclxuXHRcdHRvZ2dsZTogdHJ1ZVxyXG5cdH0sIG9wdGlvbnMpO1xyXG5cclxuXHRyZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24oaW5kZXgsIGl0ZW0pIHsgcmV0dXJuIG5ldyBFZGl0b3IoaXRlbSwgb3B0aW9ucyk7IH0pO1xyXG59OyIsIlx0fTtcclxuXHJcblx0dmFyIGFtZEF2YWlsYWJsZSA9IHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZDsgXHJcblxyXG5cdGlmKGFtZEF2YWlsYWJsZSlcclxuXHRcdGRlZmluZShbICdqcXVlcnknLCAnY29tbW9ubWFyaycgXSwgaW5pdCk7XHJcblx0XHJcblx0aWYoalF1ZXJ5ICYmIGNvbW1vbm1hcmspXHJcblx0XHRpbml0KGpRdWVyeSwgY29tbW9ubWFyaylcclxuXHRlbHNlIGlmKCFhbWRBdmFpbGFibGUpXHJcblx0XHRjb25zb2xlLmxvZygnVW5hdmJsZSB0byBsb2FkIGRlcGVuZGVuY3kgZm9yIEJvb3RzdHJhcCBDb21tb25tYXJrIEVkaXRvci4nKTtcclxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
