/*! bootstrap-commonmark-editor 0.4.0 Copyright (c) 2014, 2015 Mike Lowen */
!function(){var e=function(e,n){var t=n.Parser(),i=n.HtmlRenderer(),o=function(e){return i.render(t.parse(e))},r=function(n){var t=this,i={preview:"cm-editor-header-preview",edit:"cm-editor-header-edit",toggle:"cm-editor-header-toggle"};t.element=e('<div class="cm-editor-header"></div>'),t.on={preview:function(e){t.element.on(i.preview,e)},edit:function(e){t.element.on(i.edit,e)},toggle:function(e){t.element.on(i.toggle,e)}},t.trigger={preview:function(n){t.element.trigger(new e.Event(i.preview,n))},edit:function(n){t.element.trigger(new e.Event(i.edit,n))},toggle:function(n){t.element.trigger(new e.Event(i.toggle))}},t.toggle=function(){n.toggle&&(c.hasClass(l)?c.removeClass(l).addClass(a):c.removeClass(a).addClass(l)),r&&r.toggle(),o.toggle()};var o=e('<ul class="tabs"></ul>').append(e("<li></li>").append(e('<a href="#" class="active">Edit</a>').click(function(){return t.trigger.edit({element:this}),!1}))).append(e("<li></li>").append(e('<a href="#">Preview</a>').click(function(){return t.trigger.preview({element:this}),!1})));if(n.inline){var r=null;if(n.toggle){var l="glyphicon-pencil",a="glyphicon-remove",c=e('<span class="glyphicon"></span>').addClass(l),g=e('<a href="#" class="pull-right toggle"></a>').append(c);g.click(function(e){e.preventDefault(),t.trigger.toggle()}),t.element.append(g)}o.hide(),n.title&&(r=e('<strong class="title"></strong>').text(n.title),t.element.append(r))}n.header||t.element.addClass("transparent"),t.element.append(o);var d=function(n){t.element.find("li a.active").removeClass("active"),e(n.element).addClass("active")};t.on.edit(d),t.on.preview(d)},l=function(n){var t=this,i=null,r={change:"cm-editor-content-change"},l=e('<textarea class="form-control"></textarea>'),a=e('<div class="preview"></div>');n.name&&l.attr("name",n.name),t.states={edit:1,preview:2},t.element=e('<div class="cm-editor-content"></div>').append(l).append(a),t.state=function(e){return"undefined"==typeof e?i:void(e!=i&&(i=e,i==t.states.edit?(l.show(),a.hide()):(l.hide(),a.show())))},t.text=function(e){return"undefined"==typeof e?l.val():void(l.val()!==e&&(l.val(e),l.change()))},t.show=function(){t.element.show()},t.hide=function(){t.element.hide()},t.toggle=function(){t.element.toggle()},t.on={change:function(e){t.element.on(r.change,e)}},t.trigger={change:function(n){t.element.trigger(new e.Event(r.change,n))}};var c=function(){var e=l.val();a.html(o(e)),t.trigger.change({text:e})};l.change(c).keydown(c).keyup(c),t.state(t.states.edit)},a=function(){var n=this,t="disabled",i=e('<button class="btn btn-default">Revert changes</button>'),o=e('<button class="btn btn-success pull-right">Save</button>'),r={save:"cm-editor-footer-save",revert:"cm-editor-footer-revert"};n.element=e('<div class="cm-editor-footer"></div>'),n.disable=function(){o.prop(t,!0),i.prop(t,!0)},n.enable=function(){o.prop(t,!1),i.prop(t,!1)},n.show=function(){n.element.show()},n.hide=function(){n.element.hide()},n.toggle=function(){n.element.toggle()},n.on={save:function(e){n.element.on(r.save,e)},revert:function(e){n.element.on(r.revert,e)}},n.trigger={save:function(){n.element.trigger(new e.Event(r.save))},revert:function(){n.element.trigger(new e.Event(r.revert))}},o.click(function(e){e.preventDefault(),n.trigger.save()}),i.click(function(e){e.preventDefault(),n.trigger.revert()}),n.element.append(i).append(o),n.disable()},c=function(n,t){var i=this,c="",g={change:"cm-editor-changed",inlineToggle:"cm-editor-inline-toggle"},d=function(){v.toggle(),m.toggle(),s.toggle(),t.save&&u.toggle(),i.trigger.inlineToggle()};i.element=e(n),i.text=function(e){return"undefined"==typeof e?c:void(c!==e&&(c=e,v.text(c),m&&m.html(o(c)),i.trigger.change({text:c})))},i.inline=function(e){if(!t.inline)return!1;var n=m.is(":visible");return"undefined"==typeof e?n:void(n!=e&&d())},i.on={change:function(e){i.element.on(g.change,e)},inlineToggle:function(e){i.element.on(g.inlineToggle,e)}},i.trigger={change:function(n){i.element.trigger(new e.Event(g.change,n))},inlineToggle:function(){i.element.trigger(new e.Event(g.inlineToggle))}};var s=new r(t),v=new l(t),u=t.save?new a:null,m=t.inline?e('<div class="inline-content"></div>'):null;s.on.edit(function(){v.state(v.states.edit)}),s.on.preview(function(){v.state(v.states.preview)}),v.on.change(function(e){t.save?e.text===c?u.disable():u.enable():i.text(e.text)}),t.save&&(u.on.save(function(){i.text(v.text())}),u.on.revert(function(){v.text(i.text())})),t.inline&&(v.hide(),t.save&&u.hide(),s.on.toggle(d));var f=e('<div class="cm-editor-body"></div>').append(v.element);u&&f.append(u.element),m&&f.append(m),i.element.addClass("commonmark-editor").append(s.element).append(f),i.text(t.text)};e.fn.commonMarkEditor=function(n){return n=e.extend({header:!0,inline:!1,name:null,save:!1,text:"",title:"",toggle:!0},n),this.map(function(e,t){return new c(t,n)})}},n="function"==typeof define&&define.amd;n&&define(["jquery","commonmark"],e),jQuery&&commonmark?e(jQuery,commonmark):n||console.log("Unavble to load dependency for Bootstrap Commonmark Editor.")}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJvb3RzdHJhcC1jb21tb25tYXJrLWVkaXRvci5qcyIsInByZWZpeC5qcyIsImhlYWRlci5qcyIsImNvbnRlbnQuanMiLCJmb290ZXIuanMiLCJlZGl0b3IuanMiLCJiaW5kaW5nLmpzIiwic3VmZml4LmpzIl0sIm5hbWVzIjpbImluaXQiLCIkIiwiY29tbW9ubWFyayIsInJlYWRlciIsIlBhcnNlciIsIndyaXRlciIsIkh0bWxSZW5kZXJlciIsImNvbnZlcnQiLCJzdHIiLCJyZW5kZXIiLCJwYXJzZSIsIkhlYWRlciIsIm9wdGlvbnMiLCJzZWxmIiwidGhpcyIsImV2ZW50cyIsInByZXZpZXciLCJlZGl0IiwidG9nZ2xlIiwiZWxlbWVudCIsIm9uIiwiY2FsbGJhY2siLCJ0cmlnZ2VyIiwiZGF0YSIsIkV2ZW50IiwiZ2x5cGgiLCJoYXNDbGFzcyIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJjYW5jZWwiLCJ0aXRsZSIsInRhYnMiLCJhcHBlbmQiLCJjbGljayIsImlubGluZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImhpZGUiLCJ0ZXh0IiwiaGVhZGVyIiwiZmluZCIsIkNvbnRlbnQiLCJzdGF0ZSIsImNoYW5nZSIsInRleHRhcmVhIiwibmFtZSIsImF0dHIiLCJzdGF0ZXMiLCJzIiwic2hvdyIsInZhbCIsIm9uQ2hhbmdlIiwiaHRtbCIsImtleWRvd24iLCJrZXl1cCIsIkZvb3RlciIsInByb3BlcnR5IiwicmV2ZXJ0Iiwic2F2ZSIsImRpc2FibGUiLCJwcm9wIiwiZW5hYmxlIiwiRWRpdG9yIiwiaW5saW5lVG9nZ2xlIiwidG9nZ2xlSW5saW5lIiwiY29udGVudCIsImlubGluZUNvbnRlbnQiLCJmb290ZXIiLCJ2YWx1ZSIsImlzSW5saW5lIiwiaXMiLCJib2R5IiwiZm4iLCJjb21tb25NYXJrRWRpdG9yIiwiZXh0ZW5kIiwibWFwIiwiaW5kZXgiLCJpdGVtIiwiYW1kQXZhaWxhYmxlIiwiZGVmaW5lIiwiYW1kIiwialF1ZXJ5IiwiY29uc29sZSIs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LE9BQUEsV0FBQVEsRUFBQTNCLEtBQUF6QixFQUFBeUIsV0FHQTFCLEVBQUFzQixTQUNBK0IsRUFBQTVCLE9BRUF6QixFQUFBOEMsTUFDQVMsRUFBQTlCLE9BRUFFLEVBQUFuQixHQUFBRixPQUFBOEMsR0FJQSxJQUFBTyxHQUFBdEUsRUFBQSxzQ0FBQStCLE9BQUFpQyxFQUFBOUMsUUFFQWdELElBQ0FJLEVBQUF2QyxPQUFBbUMsRUFBQWhELFNBRUErQyxHQUNBSyxFQUFBdkMsT0FBQWtDLEdBRUFyRCxFQUFBTSxRQUFBUyxTQUFBLHFCQUNBSSxPQUFBTyxFQUFBcEIsU0FDQWEsT0FBQXVDLEdBRUExRCxFQUFBeUIsS0FBQTFCLEVBQUEwQixNQzdHQXJDLEdBQUF1RSxHQUFBQyxpQkFBQSxTQUFBN0QsR0FXQSxNQVZBQSxHQUFBWCxFQUFBeUUsUUFDQW5DLFFBQUEsRUFDQUwsUUFBQSxFQUNBVyxLQUFBLEtBQ0FhLE1BQUEsRUFDQXBCLEtBQUEsR0FDQVIsTUFBQSxHQUNBWixRQUFBLEdBQ0FOLEdBRUFFLEtBQUE2RCxJQUFBLFNBQUFDLEVBQUFDLEdBQUEsTUFBQSxJQUFBZixHQUFBZSxFQUFBakUsT0NUQWtFLEVBQUEsa0JBQUFDLFNBQUFBLE9BQUFDLEdBRUFGLElBQ0FDLFFBQUEsU0FBQSxjQUFBL0UsR0FFQWlGLFFBQUEvRSxXQUNBRixFQUFBaUYsT0FBQS9FLFlBQ0E0RSxHQUNBSSxRQUFBQyxJQUFBIiwiZmlsZSI6ImJvb3RzdHJhcC1jb21tb25tYXJrLWVkaXRvci5qcyIsInNvdXJjZXNDb250ZW50IjpbbnVsbCwiKGZ1bmN0aW9uKCkge1xyXG5cdHZhciBpbml0ID0gZnVuY3Rpb24oJCwgY29tbW9ubWFyaykge1xyXG5cdFx0dmFyIHJlYWRlciA9IGNvbW1vbm1hcmsuUGFyc2VyKCk7XHJcblx0XHR2YXIgd3JpdGVyID0gY29tbW9ubWFyay5IdG1sUmVuZGVyZXIoKTtcclxuXHJcblx0XHR2YXIgY29udmVydCA9IGZ1bmN0aW9uIChzdHIpIHsgcmV0dXJuIHdyaXRlci5yZW5kZXIocmVhZGVyLnBhcnNlKHN0cikpOyB9OyIsInZhciBIZWFkZXIgPSBmdW5jdGlvbihvcHRpb25zKSB7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdHZhciBldmVudHMgPSB7IHByZXZpZXc6ICdjbS1lZGl0b3ItaGVhZGVyLXByZXZpZXcnLCBlZGl0OiAnY20tZWRpdG9yLWhlYWRlci1lZGl0JywgdG9nZ2xlOiAnY20tZWRpdG9yLWhlYWRlci10b2dnbGUnIH07XHJcblx0XHJcblx0LyogUHVibGljIEFQSSAqL1xyXG5cdHNlbGYuZWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJjbS1lZGl0b3ItaGVhZGVyXCI+PC9kaXY+Jyk7XHJcblx0XHJcblx0Ly8gRXZlbnRzXHJcblx0c2VsZi5vbiA9IHtcclxuXHRcdHByZXZpZXc6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7IHNlbGYuZWxlbWVudC5vbihldmVudHMucHJldmlldywgY2FsbGJhY2spOyB9LFxyXG5cdFx0ZWRpdDogZnVuY3Rpb24oY2FsbGJhY2spIHsgc2VsZi5lbGVtZW50Lm9uKGV2ZW50cy5lZGl0LCBjYWxsYmFjayk7IH0sXHJcblx0XHR0b2dnbGU6IGZ1bmN0aW9uKGNhbGxiYWNrKSB7IHNlbGYuZWxlbWVudC5vbihldmVudHMudG9nZ2xlLCBjYWxsYmFjayk7IH1cclxuXHR9O1xyXG5cdFxyXG5cdHNlbGYudHJpZ2dlciA9IHtcclxuXHRcdHByZXZpZXc6IGZ1bmN0aW9uKGRhdGEpIHsgc2VsZi5lbGVtZW50LnRyaWdnZXIobmV3ICQuRXZlbnQoZXZlbnRzLnByZXZpZXcsIGRhdGEpKTsgfSxcclxuXHRcdGVkaXQ6IGZ1bmN0aW9uKGRhdGEpIHsgc2VsZi5lbGVtZW50LnRyaWdnZXIobmV3ICQuRXZlbnQoZXZlbnRzLmVkaXQsIGRhdGEpKTsgfSxcclxuXHRcdHRvZ2dsZTogZnVuY3Rpb24oZGF0YSkgeyBzZWxmLmVsZW1lbnQudHJpZ2dlcihuZXcgJC5FdmVudChldmVudHMudG9nZ2xlKSk7IH1cclxuXHR9O1xyXG5cdFxyXG5cdHNlbGYudG9nZ2xlID0gZnVuY3Rpb24oKSB7XHJcblx0XHRpZihvcHRpb25zLnRvZ2dsZSkge1xyXG5cdFx0XHRpZihnbHlwaC5oYXNDbGFzcyhlZGl0KSkge1xyXG5cdFx0XHRcdGdseXBoLnJlbW92ZUNsYXNzKGVkaXQpLmFkZENsYXNzKGNhbmNlbCk7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Z2x5cGgucmVtb3ZlQ2xhc3MoY2FuY2VsKS5hZGRDbGFzcyhlZGl0KTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFxyXG5cdFx0aWYodGl0bGUpIHRpdGxlLnRvZ2dsZSgpO1xyXG5cdFxyXG5cdFx0dGFicy50b2dnbGUoKTtcclxuXHR9O1xyXG5cdFxyXG5cdC8qIENvbnN0cnVjdG9yICovXHJcblx0XHJcblx0dmFyIHRhYnMgPSAkKCc8dWwgY2xhc3M9XCJ0YWJzXCI+PC91bD4nKVxyXG5cdFx0LmFwcGVuZChcclxuXHRcdFx0JCgnPGxpPjwvbGk+JykuYXBwZW5kKFxyXG5cdFx0XHRcdCQoJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJhY3RpdmVcIj5FZGl0PC9hPicpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRcdFx0c2VsZi50cmlnZ2VyLmVkaXQoeyBlbGVtZW50OiB0aGlzIH0pO1xyXG5cdFxyXG5cdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0XHRcdH0pXHJcblx0XHRcdClcclxuXHRcdClcclxuXHRcdC5hcHBlbmQoXHJcblx0XHRcdCQoJzxsaT48L2xpPicpLmFwcGVuZChcclxuXHRcdFx0XHQkKCc8YSBocmVmPVwiI1wiPlByZXZpZXc8L2E+JykuY2xpY2soZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0XHRzZWxmLnRyaWdnZXIucHJldmlldyh7IGVsZW1lbnQ6IHRoaXMgfSk7XHJcblx0XHJcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0KVxyXG5cdFx0KTtcclxuXHRcclxuXHRpZihvcHRpb25zLmlubGluZSkge1xyXG5cdFx0dmFyIHRpdGxlID0gbnVsbDtcclxuXHRcclxuXHRcdGlmKG9wdGlvbnMudG9nZ2xlKSB7XHJcblx0XHRcdHZhciBlZGl0ID0gJ2dseXBoaWNvbi1wZW5jaWwnO1xyXG5cdFx0XHR2YXIgY2FuY2VsID0gJ2dseXBoaWNvbi1yZW1vdmUnO1xyXG5cdFxyXG5cdFx0XHR2YXIgZ2x5cGggPSAkKCc8c3BhbiBjbGFzcz1cImdseXBoaWNvblwiPjwvc3Bhbj4nKS5hZGRDbGFzcyhlZGl0KTtcclxuXHRcdFx0dmFyIHRvZ2dsZSA9ICQoJzxhIGhyZWY9XCIjXCIgY2xhc3M9XCJwdWxsLXJpZ2h0IHRvZ2dsZVwiPjwvYT4nKS5hcHBlbmQoZ2x5cGgpO1xyXG5cdFxyXG5cdFx0XHR0b2dnbGUuY2xpY2soZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0XHRzZWxmLnRyaWdnZXIudG9nZ2xlKCk7XHJcblx0XHRcdH0pO1xyXG5cdFxyXG5cdFx0XHRzZWxmLmVsZW1lbnQuYXBwZW5kKHRvZ2dsZSk7XHJcblx0XHR9XHJcblx0XHJcblx0XHR0YWJzLmhpZGUoKTtcclxuXHRcclxuXHRcdGlmKG9wdGlvbnMudGl0bGUpIHtcclxuXHRcdFx0dGl0bGUgPSAkKCc8c3Ryb25nIGNsYXNzPVwidGl0bGVcIj48L3N0cm9uZz4nKS50ZXh0KG9wdGlvbnMudGl0bGUpO1xyXG5cdFx0XHRzZWxmLmVsZW1lbnQuYXBwZW5kKHRpdGxlKTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0aWYoIW9wdGlvbnMuaGVhZGVyKVxyXG5cdFx0c2VsZi5lbGVtZW50LmFkZENsYXNzKCd0cmFuc3BhcmVudCcpO1xyXG5cdFxyXG5cdHNlbGYuZWxlbWVudC5hcHBlbmQodGFicyk7XHJcblx0XHJcblx0Ly8gVGllIHVwIGludGVybmFsIGV2ZW50c1xyXG5cdHZhciBjbGljayA9IGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdHNlbGYuZWxlbWVudC5maW5kKCdsaSBhLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuXHRcdCQoZGF0YS5lbGVtZW50KS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcblx0fTtcclxuXHRcclxuXHRzZWxmLm9uLmVkaXQoY2xpY2spO1xyXG5cdHNlbGYub24ucHJldmlldyhjbGljayk7XHJcbn0iLCJ2YXIgQ29udGVudCA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuXHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0dmFyIHN0YXRlID0gbnVsbDtcclxuXHR2YXIgZXZlbnRzID0geyBjaGFuZ2U6ICdjbS1lZGl0b3ItY29udGVudC1jaGFuZ2UnIH07XHJcblxyXG5cdHZhciB0ZXh0YXJlYSA9ICQoJzx0ZXh0YXJlYSBjbGFzcz1cImZvcm0tY29udHJvbFwiPjwvdGV4dGFyZWE+Jyk7XHJcblx0dmFyIHByZXZpZXcgPSAkKCc8ZGl2IGNsYXNzPVwicHJldmlld1wiPjwvZGl2PicpO1xyXG5cclxuXHRpZihvcHRpb25zLm5hbWUpXHJcblx0XHR0ZXh0YXJlYS5hdHRyKCduYW1lJywgb3B0aW9ucy5uYW1lKTtcclxuXHJcblx0LyogUHVibGljIEFQSSAqL1xyXG5cdHNlbGYuc3RhdGVzID0geyBlZGl0OiAxLCBwcmV2aWV3OiAyIH1cclxuXHRzZWxmLmVsZW1lbnQgPSAkKCc8ZGl2IGNsYXNzPVwiY20tZWRpdG9yLWNvbnRlbnRcIj48L2Rpdj4nKVxyXG5cdFx0LmFwcGVuZCh0ZXh0YXJlYSlcclxuXHRcdC5hcHBlbmQocHJldmlldyk7XHJcblxyXG5cdC8vIE1ldGhvZHNcclxuXHRzZWxmLnN0YXRlID0gZnVuY3Rpb24ocykge1xyXG5cdFx0aWYodHlwZW9mIHMgPT09ICd1bmRlZmluZWQnKSByZXR1cm4gc3RhdGU7XHJcblx0XHRpZihzID09IHN0YXRlKSByZXR1cm47XHJcblxyXG5cdFx0c3RhdGUgPSBzO1xyXG5cclxuXHRcdGlmKHN0YXRlID09IHNlbGYuc3RhdGVzLmVkaXQpIHtcclxuXHRcdFx0dGV4dGFyZWEuc2hvdygpO1xyXG5cdFx0XHRwcmV2aWV3LmhpZGUoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHRleHRhcmVhLmhpZGUoKTtcclxuXHRcdFx0cHJldmlldy5zaG93KCk7XHJcblx0XHR9XHJcblx0fTtcclxuXHJcblx0c2VsZi50ZXh0ID0gZnVuY3Rpb24odGV4dCkge1xyXG5cdFx0aWYodHlwZW9mIHRleHQgPT09ICd1bmRlZmluZWQnKSByZXR1cm4gdGV4dGFyZWEudmFsKCk7XHJcblxyXG5cdFx0Ly8gTGV0cyBub3QgY2F1c2UgdW5uZWNlc3NhcnkgcmVzZXR0aW5nIG9mIHRleHQgYW5kIGZpcmUgdW5uZWVkZWQgZXZlbnRzLlxyXG5cdFx0aWYodGV4dGFyZWEudmFsKCkgPT09IHRleHQpXHJcblx0XHRcdHJldHVybjtcclxuXHJcblx0XHR0ZXh0YXJlYS52YWwodGV4dCk7XHJcblx0XHR0ZXh0YXJlYS5jaGFuZ2UoKTtcclxuXHR9XHJcblxyXG5cdHNlbGYuc2hvdyA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQuc2hvdygpOyB9O1xyXG5cdHNlbGYuaGlkZSA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQuaGlkZSgpOyB9O1xyXG5cdHNlbGYudG9nZ2xlID0gZnVuY3Rpb24oKSB7IHNlbGYuZWxlbWVudC50b2dnbGUoKTsgfTtcclxuXHJcblx0Ly8gRXZlbnRzXHJcblx0c2VsZi5vbiA9IHsgY2hhbmdlOiBmdW5jdGlvbihjYWxsYmFjaykgeyBzZWxmLmVsZW1lbnQub24oZXZlbnRzLmNoYW5nZSwgY2FsbGJhY2spOyB9IH07XHJcblx0c2VsZi50cmlnZ2VyID0geyBjaGFuZ2U6IGZ1bmN0aW9uKGRhdGEpIHsgc2VsZi5lbGVtZW50LnRyaWdnZXIobmV3ICQuRXZlbnQoZXZlbnRzLmNoYW5nZSwgZGF0YSkpOyB9IH07XHJcblxyXG5cdC8vIENvbnN0cnVjdFxyXG5cclxuXHR2YXIgb25DaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdHZhciB0ZXh0ID0gdGV4dGFyZWEudmFsKCk7XHJcblxyXG5cdFx0cHJldmlldy5odG1sKGNvbnZlcnQodGV4dCkpO1xyXG5cdFx0c2VsZi50cmlnZ2VyLmNoYW5nZSh7IHRleHQ6IHRleHQgfSk7XHJcblx0fTtcclxuXHJcblx0dGV4dGFyZWEuY2hhbmdlKG9uQ2hhbmdlKS5rZXlkb3duKG9uQ2hhbmdlKS5rZXl1cChvbkNoYW5nZSk7XHJcblxyXG5cdHNlbGYuc3RhdGUoc2VsZi5zdGF0ZXMuZWRpdCk7XHJcbn0iLCJ2YXIgRm9vdGVyID0gZnVuY3Rpb24oKSB7XHJcblx0dmFyIHNlbGYgPSB0aGlzO1xyXG5cdHZhciBwcm9wZXJ0eSA9ICdkaXNhYmxlZCc7XHJcblx0dmFyIHJldmVydCA9ICQoJzxidXR0b24gY2xhc3M9XCJidG4gYnRuLWRlZmF1bHRcIj5SZXZlcnQgY2hhbmdlczwvYnV0dG9uPicpO1xyXG5cdHZhciBzYXZlID0gJCgnPGJ1dHRvbiBjbGFzcz1cImJ0biBidG4tc3VjY2VzcyBwdWxsLXJpZ2h0XCI+U2F2ZTwvYnV0dG9uPicpO1xyXG5cdHZhciBldmVudHMgPSB7IHNhdmU6ICdjbS1lZGl0b3ItZm9vdGVyLXNhdmUnLCByZXZlcnQ6ICdjbS1lZGl0b3ItZm9vdGVyLXJldmVydCcgfTtcclxuXHJcblx0LyogUHVibGljIEFQSSAqL1xyXG5cdHNlbGYuZWxlbWVudCA9ICQoJzxkaXYgY2xhc3M9XCJjbS1lZGl0b3ItZm9vdGVyXCI+PC9kaXY+Jyk7XHJcblxyXG5cdC8vIE1ldGhvZHNcclxuXHRzZWxmLmRpc2FibGUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHNhdmUucHJvcChwcm9wZXJ0eSwgdHJ1ZSk7XHJcblx0XHRyZXZlcnQucHJvcChwcm9wZXJ0eSwgdHJ1ZSk7XHJcblx0fTtcclxuXHJcblx0c2VsZi5lbmFibGUgPSBmdW5jdGlvbigpIHtcclxuXHRcdHNhdmUucHJvcChwcm9wZXJ0eSwgZmFsc2UpO1xyXG5cdFx0cmV2ZXJ0LnByb3AocHJvcGVydHksIGZhbHNlKTtcclxuXHR9O1xyXG5cclxuXHRzZWxmLnNob3cgPSBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LnNob3coKTsgfTtcclxuXHRzZWxmLmhpZGUgPSBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LmhpZGUoKTsgfTtcclxuXHRzZWxmLnRvZ2dsZSA9IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQudG9nZ2xlKCk7IH07XHJcblxyXG5cdC8vIEV2ZW50c1xyXG5cdHNlbGYub24gPSB7XHJcblx0XHRzYXZlOiBmdW5jdGlvbihjYWxsYmFjaykgeyBzZWxmLmVsZW1lbnQub24oZXZlbnRzLnNhdmUsIGNhbGxiYWNrKTsgfSxcclxuXHRcdHJldmVydDogZnVuY3Rpb24oY2FsbGJhY2spIHsgc2VsZi5lbGVtZW50Lm9uKGV2ZW50cy5yZXZlcnQsIGNhbGxiYWNrKTsgfSxcclxuXHR9O1xyXG5cclxuXHRzZWxmLnRyaWdnZXIgPSB7XHJcblx0XHRzYXZlOiBmdW5jdGlvbigpIHsgc2VsZi5lbGVtZW50LnRyaWdnZXIobmV3ICQuRXZlbnQoZXZlbnRzLnNhdmUpKTsgfSxcclxuXHRcdHJldmVydDogZnVuY3Rpb24oKSB7IHNlbGYuZWxlbWVudC50cmlnZ2VyKG5ldyAkLkV2ZW50KGV2ZW50cy5yZXZlcnQpKTsgfSxcclxuXHR9O1xyXG5cclxuXHQvKiBDb25zdHJ1Y3QgKi9cclxuXHRzYXZlLmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuXHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdHNlbGYudHJpZ2dlci5zYXZlKCk7XHJcblx0fSk7XHJcblxyXG5cdHJldmVydC5jbGljayhmdW5jdGlvbihlKSB7XHJcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRzZWxmLnRyaWdnZXIucmV2ZXJ0KCk7XHJcblx0fSk7XHJcblxyXG5cdHNlbGYuZWxlbWVudC5hcHBlbmQocmV2ZXJ0KS5hcHBlbmQoc2F2ZSk7XHJcblx0c2VsZi5kaXNhYmxlKCk7XHJcbn07IiwidmFyIEVkaXRvciA9IGZ1bmN0aW9uKGVsZW1lbnQsIG9wdGlvbnMpIHtcclxuXHR2YXIgc2VsZiA9IHRoaXM7XHJcblx0dmFyIHRleHQgPSAnJztcclxuXHJcblx0dmFyIGV2ZW50cyA9IHsgY2hhbmdlOiAnY20tZWRpdG9yLWNoYW5nZWQnLCBpbmxpbmVUb2dnbGU6ICdjbS1lZGl0b3ItaW5saW5lLXRvZ2dsZScgfTtcclxuXHJcblx0LyogVXRpbGl0eSBmdW5jdGlvbnMgKi9cclxuXHR2YXIgdG9nZ2xlSW5saW5lID0gZnVuY3Rpb24oKSB7XHJcblx0XHRjb250ZW50LnRvZ2dsZSgpO1xyXG5cdFx0aW5saW5lQ29udGVudC50b2dnbGUoKTtcclxuXHRcdGhlYWRlci50b2dnbGUoKTtcclxuXHJcblx0XHRpZihvcHRpb25zLnNhdmUpXHJcblx0XHRcdGZvb3Rlci50b2dnbGUoKTtcclxuXHJcblx0XHRzZWxmLnRyaWdnZXIuaW5saW5lVG9nZ2xlKCk7XHJcblx0fTtcclxuXHJcblx0LyogUHVibGljIEFQSSAqL1xyXG5cdHNlbGYuZWxlbWVudCA9ICQoZWxlbWVudCk7XHJcblxyXG5cdC8vIE1ldGhvZHNcclxuXHRzZWxmLnRleHQgPSBmdW5jdGlvbih2YWx1ZSkge1xyXG5cdFx0aWYodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJylcclxuXHRcdFx0cmV0dXJuIHRleHQ7XHJcblxyXG5cdFx0aWYodGV4dCA9PT0gdmFsdWUpIHJldHVybjtcclxuXHJcblx0XHR0ZXh0ID0gdmFsdWU7XHJcblx0XHRjb250ZW50LnRleHQodGV4dCk7XHJcblxyXG5cdFx0aWYoaW5saW5lQ29udGVudClcclxuXHRcdFx0aW5saW5lQ29udGVudC5odG1sKGNvbnZlcnQodGV4dCkpO1xyXG5cclxuXHRcdHNlbGYudHJpZ2dlci5jaGFuZ2UoeyB0ZXh0OiB0ZXh0IH0pO1xyXG5cdH07XHJcblxyXG5cdHNlbGYuaW5saW5lID0gZnVuY3Rpb24odmFsdWUpIHtcclxuXHRcdGlmKCFvcHRpb25zLmlubGluZSlcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cclxuXHRcdHZhciBpc0lubGluZSA9IGlubGluZUNvbnRlbnQuaXMoJzp2aXNpYmxlJyk7XHJcblxyXG5cdFx0aWYodHlwZW9mIHZhbHVlID09PSAndW5kZWZpbmVkJylcclxuXHRcdFx0cmV0dXJuIGlzSW5saW5lO1xyXG5cclxuXHRcdGlmKGlzSW5saW5lICE9IHZhbHVlKVxyXG5cdFx0XHR0b2dnbGVJbmxpbmUoKTtcclxuXHR9O1xyXG5cclxuXHQvLyBFdmVudHNcclxuXHJcblx0c2VsZi5vbiA9IHtcclxuXHRcdGNoYW5nZTogZnVuY3Rpb24oY2FsbGJhY2spIHsgc2VsZi5lbGVtZW50Lm9uKGV2ZW50cy5jaGFuZ2UsIGNhbGxiYWNrKTsgfSxcclxuXHRcdGlubGluZVRvZ2dsZTogZnVuY3Rpb24oY2FsbGJhY2spIHsgc2VsZi5lbGVtZW50Lm9uKGV2ZW50cy5pbmxpbmVUb2dnbGUsIGNhbGxiYWNrKTsgfVxyXG5cdH07XHJcblxyXG5cdHNlbGYudHJpZ2dlciA9IHtcclxuXHRcdGNoYW5nZTogZnVuY3Rpb24oZGF0YSkgeyBzZWxmLmVsZW1lbnQudHJpZ2dlcihuZXcgJC5FdmVudChldmVudHMuY2hhbmdlLCBkYXRhKSk7IH0sXHJcblx0XHRpbmxpbmVUb2dnbGU6IGZ1bmN0aW9uKCkgeyBzZWxmLmVsZW1lbnQudHJpZ2dlcihuZXcgJC5FdmVudChldmVudHMuaW5saW5lVG9nZ2xlKSk7IH1cclxuXHR9O1xyXG5cclxuXHQvKiBDb25zdHJ1Y3RvciAqL1xyXG5cdHZhciBoZWFkZXIgPSBuZXcgSGVhZGVyKG9wdGlvbnMpO1xyXG5cdHZhciBjb250ZW50ID0gbmV3IENvbnRlbnQob3B0aW9ucyk7XHJcblx0dmFyIGZvb3RlciA9IG9wdGlvbnMuc2F2ZSA/IG5ldyBGb290ZXIoKSA6IG51bGw7XHJcblx0dmFyIGlubGluZUNvbnRlbnQgPSBvcHRpb25zLmlubGluZSA/ICQoJzxkaXYgY2xhc3M9XCJpbmxpbmUtY29udGVudFwiPjwvZGl2PicpIDogbnVsbDtcclxuXHJcblx0Ly8gU3Vic2NyaWJlIHRvIGV2ZW50c1xyXG5cclxuXHRoZWFkZXIub24uZWRpdChmdW5jdGlvbigpIHsgY29udGVudC5zdGF0ZShjb250ZW50LnN0YXRlcy5lZGl0KTsgfSk7XHJcblx0aGVhZGVyLm9uLnByZXZpZXcoZnVuY3Rpb24oKSB7IGNvbnRlbnQuc3RhdGUoY29udGVudC5zdGF0ZXMucHJldmlldyk7IH0pO1xyXG5cclxuXHRjb250ZW50Lm9uLmNoYW5nZShmdW5jdGlvbihkYXRhKSB7XHJcblx0XHRpZihvcHRpb25zLnNhdmUpIHtcclxuXHRcdFx0aWYoZGF0YS50ZXh0ID09PSB0ZXh0KSBmb290ZXIuZGlzYWJsZSgpO1xyXG5cdFx0XHRlbHNlIGZvb3Rlci5lbmFibGUoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHNlbGYudGV4dChkYXRhLnRleHQpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG5cclxuXHRpZihvcHRpb25zLnNhdmUpIHtcclxuXHRcdGZvb3Rlci5vbi5zYXZlKGZ1bmN0aW9uKCkgeyBzZWxmLnRleHQoY29udGVudC50ZXh0KCkpOyB9KTtcclxuXHRcdGZvb3Rlci5vbi5yZXZlcnQoZnVuY3Rpb24oKSB7IGNvbnRlbnQudGV4dChzZWxmLnRleHQoKSk7IH0pO1xyXG5cdH1cclxuXHJcblx0aWYob3B0aW9ucy5pbmxpbmUpIHtcclxuXHRcdGNvbnRlbnQuaGlkZSgpO1xyXG5cclxuXHRcdGlmKG9wdGlvbnMuc2F2ZSlcclxuXHRcdFx0Zm9vdGVyLmhpZGUoKTtcclxuXHJcblx0XHRoZWFkZXIub24udG9nZ2xlKHRvZ2dsZUlubGluZSk7XHJcblx0fVxyXG5cclxuXHQvLyBBZGQgYWxsIHRoZSBlbGVtZW50c1xyXG5cdHZhciBib2R5ID0gJCgnPGRpdiBjbGFzcz1cImNtLWVkaXRvci1ib2R5XCI+PC9kaXY+JykuYXBwZW5kKGNvbnRlbnQuZWxlbWVudCk7XHJcblxyXG5cdGlmKGZvb3RlcilcclxuXHRcdGJvZHkuYXBwZW5kKGZvb3Rlci5lbGVtZW50KTtcclxuXHJcblx0aWYoaW5saW5lQ29udGVudClcclxuXHRcdGJvZHkuYXBwZW5kKGlubGluZUNvbnRlbnQpO1xyXG5cclxuXHRzZWxmLmVsZW1lbnQuYWRkQ2xhc3MoJ2NvbW1vbm1hcmstZWRpdG9yJylcclxuXHRcdC5hcHBlbmQoaGVhZGVyLmVsZW1lbnQpXHJcblx0XHQuYXBwZW5kKGJvZHkpO1xyXG5cclxuXHRzZWxmLnRleHQob3B0aW9ucy50ZXh0KTtcclxufSIsIiQuZm4uY29tbW9uTWFya0VkaXRvciA9IGZ1bmN0aW9uKG9wdGlvbnMpIHtcclxuXHRvcHRpb25zID0gJC5leHRlbmQoe1xyXG5cdFx0aGVhZGVyOiB0cnVlLFxyXG5cdFx0aW5saW5lOiBmYWxzZSxcclxuXHRcdG5hbWU6IG51bGwsXHJcblx0XHRzYXZlOiBmYWxzZSxcclxuXHRcdHRleHQ6ICcnLFxyXG5cdFx0dGl0bGU6ICcnLFxyXG5cdFx0dG9nZ2xlOiB0cnVlXHJcblx0fSwgb3B0aW9ucyk7XHJcblxyXG5cdHJldHVybiB0aGlzLm1hcChmdW5jdGlvbihpbmRleCwgaXRlbSkgeyByZXR1cm4gbmV3IEVkaXRvcihpdGVtLCBvcHRpb25zKTsgfSk7XHJcbn07IiwiXHR9O1xyXG5cclxuXHR2YXIgYW1kQXZhaWxhYmxlID0gdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kOyBcclxuXHJcblx0aWYoYW1kQXZhaWxhYmxlKVxyXG5cdFx0ZGVmaW5lKFsgJ2pxdWVyeScsICdjb21tb25tYXJrJyBdLCBpbml0KTtcclxuXHRcclxuXHRpZihqUXVlcnkgJiYgY29tbW9ubWFyaylcclxuXHRcdGluaXQoalF1ZXJ5LCBjb21tb25tYXJrKVxyXG5cdGVsc2UgaWYoIWFtZEF2YWlsYWJsZSlcclxuXHRcdGNvbnNvbGUubG9nKCdVbmF2YmxlIHRvIGxvYWQgZGVwZW5kZW5jeSBmb3IgQm9vdHN0cmFwIENvbW1vbm1hcmsgRWRpdG9yLicpO1xyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
