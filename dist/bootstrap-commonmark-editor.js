/*! bootstrap-commonmark-editor-0.4.0 2015-11-09 */

!function(){var a=function(a,b){var c=b.Parser(),d=b.HtmlRenderer(),e=function(a){return d.render(c.parse(a))},f=function(b){var c=this,d={preview:"cm-editor-header-preview",edit:"cm-editor-header-edit",toggle:"cm-editor-header-toggle"};c.element=a('<div class="cm-editor-header"></div>'),c.on={preview:function(a){c.element.on(d.preview,a)},edit:function(a){c.element.on(d.edit,a)},toggle:function(a){c.element.on(d.toggle,a)}},c.trigger={preview:function(b){c.element.trigger(new a.Event(d.preview,b))},edit:function(b){c.element.trigger(new a.Event(d.edit,b))},toggle:function(b){c.element.trigger(new a.Event(d.toggle))}},c.toggle=function(){b.toggle&&(i.hasClass(g)?i.removeClass(g).addClass(h):i.removeClass(h).addClass(g)),f&&f.toggle(),e.toggle()};var e=a('<ul class="tabs"></ul>').append(a("<li></li>").append(a('<a href="#" class="active">Edit</a>').click(function(){return c.trigger.edit({element:this}),!1}))).append(a("<li></li>").append(a('<a href="#">Preview</a>').click(function(){return c.trigger.preview({element:this}),!1})));if(b.inline){var f=null;if(b.toggle){var g="glyphicon-pencil",h="glyphicon-remove",i=a('<span class="glyphicon"></span>').addClass(g),j=a('<a href="#" class="pull-right toggle"></a>').append(i);j.click(function(a){a.preventDefault(),c.trigger.toggle()}),c.element.append(j)}e.hide(),b.title&&(f=a('<strong class="title"></strong>').text(b.title),c.element.append(f))}b.header||c.element.addClass("transparent"),c.element.append(e);var k=function(b){c.element.find("li a.active").removeClass("active"),a(b.element).addClass("active")};c.on.edit(k),c.on.preview(k)},g=function(b){var c=this,d=null,f={change:"cm-editor-content-change"},g=a('<textarea class="form-control"></textarea>'),h=a('<div class="preview"></div>');b.name&&g.attr("name",b.name),c.states={edit:1,preview:2},c.element=a('<div class="cm-editor-content"></div>').append(g).append(h),c.state=function(a){return"undefined"==typeof a?d:void(a!=d&&(d=a,d==c.states.edit?(g.show(),h.hide()):(g.hide(),h.show())))},c.text=function(a){return"undefined"==typeof a?g.val():void(g.val()!==a&&(g.val(a),g.change()))},c.show=function(){c.element.show()},c.hide=function(){c.element.hide()},c.toggle=function(){c.element.toggle()},c.on={change:function(a){c.element.on(f.change,a)}},c.trigger={change:function(b){c.element.trigger(new a.Event(f.change,b))}};var i=function(){var a=g.val();h.html(e(a)),c.trigger.change({text:a})};g.change(i).keydown(i).keyup(i),c.state(c.states.edit)},h=function(){var b=this,c="disabled",d=a('<button class="btn btn-default">Revert changes</button>'),e=a('<button class="btn btn-success pull-right">Save</button>'),f={save:"cm-editor-footer-save",revert:"cm-editor-footer-revert"};b.element=a('<div class="cm-editor-footer"></div>'),b.disable=function(){e.prop(c,!0),d.prop(c,!0)},b.enable=function(){e.prop(c,!1),d.prop(c,!1)},b.show=function(){b.element.show()},b.hide=function(){b.element.hide()},b.toggle=function(){b.element.toggle()},b.on={save:function(a){b.element.on(f.save,a)},revert:function(a){b.element.on(f.revert,a)}},b.trigger={save:function(){b.element.trigger(new a.Event(f.save))},revert:function(){b.element.trigger(new a.Event(f.revert))}},e.click(function(a){a.preventDefault(),b.trigger.save()}),d.click(function(a){a.preventDefault(),b.trigger.revert()}),b.element.append(d).append(e),b.disable()},i=function(b,c){var d=this,i="",j={change:"cm-editor-changed",inlineToggle:"cm-editor-inline-toggle"},k=function(){m.toggle(),o.toggle(),l.toggle(),c.save&&n.toggle(),d.trigger.inlineToggle()};d.element=a(b),d.text=function(a){return"undefined"==typeof a?i:void(i!==a&&(i=a,m.text(i),o&&o.html(e(i)),d.trigger.change({text:i})))},d.inline=function(a){if(!c.inline)return!1;var b=o.is(":visible");return"undefined"==typeof a?b:void(b!=a&&k())},d.on={change:function(a){d.element.on(j.change,a)},inlineToggle:function(a){d.element.on(j.inlineToggle,a)}},d.trigger={change:function(b){d.element.trigger(new a.Event(j.change,b))},inlineToggle:function(){d.element.trigger(new a.Event(j.inlineToggle))}};var l=new f(c),m=new g(c),n=c.save?new h:null,o=c.inline?a('<div class="inline-content"></div>'):null;l.on.edit(function(){m.state(m.states.edit)}),l.on.preview(function(){m.state(m.states.preview)}),m.on.change(function(a){c.save?a.text===i?n.disable():n.enable():d.text(a.text)}),c.save&&(n.on.save(function(){d.text(m.text())}),n.on.revert(function(){m.text(d.text())})),c.inline&&(m.hide(),c.save&&n.hide(),l.on.toggle(k));var p=a('<div class="cm-editor-body"></div>').append(m.element);n&&p.append(n.element),o&&p.append(o),d.element.addClass("commonmark-editor").append(l.element).append(p),d.text(c.text)};a.fn.commonMarkEditor=function(b){return b=a.extend({header:!0,inline:!1,name:null,save:!1,text:"",title:"",toggle:!0},b),this.map(function(a,c){return new i(c,b)})}};"function"==typeof define&&define.amd?define(["jquery","commonmark"],a):a(jQuery,commonmark)}();
//# sourceMappingURL=bootstrap-commonmark-editor.js.map